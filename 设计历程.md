

## 09/17

- 测试了一下原作和本作的地图差异，得到一些数据
	- 原作前置的景色一般要放大5倍
	- 后置的背景也要放大2倍
	- 原作的窗口大概是长1510，宽840，或许有更精确的数值比，但影响不大
	- 如何实现这一放大呢？
		- 相机肯定不行，主要靠tilelayer自己
		- 直接放大TileLayer即可
	- 注意到原作地图分为三层，这里命名为【背景层】【内层】【外层】
	- 同时，内外层还有一个描边。将单独的一块地形用黑色描边。这要如何实现呢？
		- 直接对其整体描边可以吗？测试一下
			- 不行
			- 因为原有的outline是基于sprite2d的texture属性进行的，肯定不能直接用来这里啊！
		- 找到一个类似的属性进行操作即可。但现有水平不够，暂时不能解决这个问题。
		- 问大佬去了
	- 内层地图相较于外层地图，有一个虚化的着色器就行
		- 调节了他的透明度，近似达到了原作的效果，暂时如此即可
	- 背景地图似乎是一个视差背景图，到时候再研究吧

## 09/18

- 在JACKADUX大佬的帮助下，解决了给tilemaplayer描边的问题
	- 给tilemap一个CanvasGroup的父节点，然后抄一个专门给CanvasGroup描边的着色器就好了
- 似乎景色放大倍数大了一点点，到时候再调吧
- 思考一下视差背景怎么做
	- 不知道滚动什么的咋用，暂时先这样吧
- 做了一个测试用的戴夫，用来看看风景
- 思考寻路和特殊地形：水/梯子
	- 用了一个shader来实现水的动画，但他变化的太快了，不知道咋改啊
	- 这可能又需要问问大佬们了
	- 搞定，但效果不好，可能还得用动画，但是，这样没有随机性啊？？？

## 09/19

- 今天继续观察寻路和水的效果，以及看看tilemap要放大几倍才好
	- 内外层的tilemap调整为放大4.62倍，不喜欢非整数倍，但也没什么办法
	- 戴夫放大4倍，且图层位于地图之后
- 准备做寻路相关事宜
	- 基本思路已经搞好
		- 但是，“水”的地形还没搞好
	- 具体思路是
		- 导入两个TileMapLayer变量，分别是【外部地图】【水地图】
		- 分别依据两个地图生成各种点
			- 参考B站那个视频，额外需要设计“水”中的点
		- 使用AStar2D来连接各种点，但没有什么“横跳”的线
			- 担心僵尸会走回头路，得想一想怎么跳过一些点
			- 或者是经过一些点后判断要不要删除或重新寻路？
		- 僵尸脚本处理这些点，向上就跳，这里没有跳跃能力的说法，僵尸也不会找梯子

## 09/23

- 这几天解决了“水”的视觉效果
	- “水”的物理效果不是很有思路，目前的想法是通过Area2D来让实体知道进入了水之中
	- 但是，如何是实体上下浮动呢？且在水覆盖后上浮呢？
	- 注意，刚进入水时速度要几乎0，开始重新计算

- 开始写戴夫的移动代码
	- 注意，僵尸的移动绝绝绝大部分和戴夫是一致的，可以先在戴夫这测试测试，再移植到僵尸上
	- 暂时不引入“状态机”，尽可能把代码功能写出来，再来搞状态机
	- 目前的问题
		- 希望戴夫靠墙时无法倾斜
		- 二段跳时的旋转不知道咋搞
		- 其他的细节

- 暂时先这样，加油干，这周把移动基本干好，国庆肯定可以搞定寻路

## 09/24

- 早上：
	- 把旋转加前移实现了，但一些细节处理的不好，还需要重构一次
- 晚上：
	- 感觉横向移动+跳跃干的还不错，并且也把基本函数抽象出来了
	- 似乎不错，之后再看看有什么要改动的吧，特别是一些参数
	- 像素抖动、起步与原作不同且不协调
		- 抖动已OK——开启物理插值即可
		- 还需要调整一下【下落速度】
		- 以及把各个参数抽象出来，为普通僵尸什么的创造条件

## 09/25

- 今天把梯子效果实现一下看看
	- 具体效果
		- 代替跳跃
		- 跳跃数刷新
		- 自动变化
		- 处于梯子状态时，横移不会产生大的偏移且速度有限
	- 要求
		- 一是梯子代替跳跃以及其他逻辑
		- 二是梯子的自动变化（三端变化，最好写个检测出来）
		- 三是对状态机和单独的移动函数的思考
	- 目前
		- 不好给他们自动化，我的想法是地图更改特别是梯子有破坏或新建时才有一个判断，但基础已经打好了
		- 需要整理一下目前的文件架构了，不然之后会更乱
		- 注意，cast需要开启hit_from_inside属性才可以检测全部的区域而不是一个点，以及检测的是area还是body
		- 今天的成果就是实现了梯子的效果，但动画部分需要等到可破坏地形后才好处理，并且需要知道如何判断有没有梯子（或许应该交给梯子tilemap解决）

## 09/26

- 明确了场景合集对于TilemapLayer的意义
- 重构梯子Layer
	- 实现了梯子自动变换，之后有场景破坏后再调动函数即可
- 重构水的场景结构
	- 视觉上，发现有重影bug
	- 物理还是没有大的思路，明早再做
- 注意，粒子是有碰撞的，会与world层/water碰撞
- 注意，僵尸的头、身子和头盔等都会沉到水里
- 注意，僵尸攻击后不可主动移动一段时间（在梯子上为掉下来一段距离）
- 准备了一个move节点，打算开始把移动脚本脱离主脚本

## 09/27

- 优化了梯子代码
	- 一是利用了local_to_map函数，这要求我们先找梯子，由梯子即可知道坐标cell，而不是反过来
	- 二是使用了child_order_changed信号，现在不需要额外的信号来提醒LadderLayer变化梯子动画了
- 解决了“水”的重叠！
	— 伟大的CanvasGroup！
- “水”的物理效果还是没有成功
	- 成功找到了top-water
	- 漂浮有点小问题，特别是刚开始的处理（高速进入水中）
	- 同时，在“水”中，刚开始是不能跳跃的，这个效果不好实现
	- 我觉得是时候引入状态概念了
		- 进入水时速度骤降且不可跳跃
		- 进入水时需要到达漂浮的最低点后才可以跳跃
		- 之后正常漂浮移动
		- 或许这个漂浮就是在最低点“小跳”罢了
